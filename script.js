var preguntas = [
  {
    pregunta:
      "La proteína Math1 (factor de transcripción específico) tiene un dominio de unión a ADN hélix-loophélix por ello:",
    opciones: [
      "Presenta en su secuencia, regiones que codifican a los aminoácidos que funcionarán como señal de localización nuclear y su síntesis ocurre en polirribosomas libres.",
      "Durante su procesamiento en el RER y Golgi, se agregarán modificaciones postraduccionales que permitirán su ingreso al núcleo.",
      "Presenta en su secuencia, regiones que codifican a los aminoácidos que funcionarán como péptido señal para su síntesis en ribosomas asociados al RER.",
      "Presenta en la estructura final proteica, aminoácidos que funcionarán como señal de localización nuclear producto de modificaciones postraduccionales en el citosol",
    ],
    respuestaCorrecta:
      "Presenta en su secuencia, regiones que codifican a los aminoácidos que funcionarán como señal de localización nuclear y su síntesis ocurre en polirribosomas libres.",
  },

  {
    pregunta:
      "La alteración del proceso de invasión trofoblástica puede desencadenar preeclampsia. Esta es una patología que aumenta la mortalidad materna. Un factor descrito habitualmente en su patogénesis, es el aumento de la secreción trofoblástica de una proteína inhibidora de VEGF (factor de crecimiento del endotelio vascular), denominada sFLT-1. La síntesis de sFLT-1 implica:",
    opciones: [
      "La traducción de un péptido señal codificado en el transcripto maduro.",
      "El agregado de manosa-6-fosfato en el aparato de Golgi.",
      "La finalización de la transcripción en el REG.",
      "El plegamiento de la proteína a través de chaperonas citosólicas.",
    ],
    respuestaCorrecta:
      "La traducción de un péptido señal codificado en el transcripto maduro.",
  },

  {
    pregunta:
      "La capacidad invasiva de las células neoplásicas malignas se ve favorecida por su capacidad para remodelar la matriz extracelular mediante la síntesis y actividad de proteínas metaloproteasas de la matriz extracelular. En este proceso participan los siguientes mecanismos moleculares:",
    opciones: [
      "Síntesis proteica en el retículo endoplasmático rugoso (REG), modificaciones en REG y aparato de Golgi; y transporte por la vía secretora.",
      "Síntesis en membrana plasmática, internalización mediada por receptor y transporte retrógrado hacia el cuerpo celular.",
      "Inicio de síntesis proteica en ribosomas libres, su terminación en el citosol y secreción por canales de la membrana plasmática.",
      "Síntesis proteica en el retículo endoplasmático rugoso (REG), modificaciones en el aparato de Golgi, y transporte por la vía de degradación endo-lisosomal.",
    ],
    respuestaCorrecta:
      "Síntesis proteica en el retículo endoplasmático rugoso (REG), modificaciones en REG y aparato de Golgi; y transporte por la vía secretora.",
  },

  {
    pregunta:
      "¿Cuál de los siguientes procesos de maduración de una glicoproteína de exportación ocurre durante su paso por la vía secretora?",
     opciones: [
        "Plegamiento en el Aparato de Golgi por ubiquitinación.",
        "Glicosilación en el retículo endoplasmático rugoso (RER).",
        "Unión a endosomas.",
        "Anclaje a la membrana del retículo endoplasmático liso (REL)."
    ],
    respuestaCorrecta: "Glicosilación en el retículo endoplasmático rugoso (RER)."
  },

  {
    pregunta:
      "La autofagia es un evento celular que ocurre ante diferentes situaciones. Señale cuál de las siguientes opciones es la correcta respecto a este proceso:",
    opciones: [
        "Los productos de la degradación de las biomoléculas no son reciclados.",
        "Las mitocondrias disfuncionales no pueden ser eliminadas por este proceso.",
        "Permite eliminar proteínas mal plegadas.",
        "La digestión se da en los peroxisomas."
    ],
    respuestaCorrecta: "Permite eliminar proteínas mal plegadas."
  },

  {
    pregunta:
      "Una mutación provoca que la proteína de transmembarna adquiera una conformación mal plegada. Como consecuencia del mal plegamiento, la proteína es:",
    opciones: [
        "poliubiquitinizada luego de su síntesis en ribosomas libres",
        "transportada para su degradación al lisosoma por medio de la señal de manosa 6 fosfato",
        "secretada porque carece de partícula de reconocimiento (PRS) de asociación a Retículo Endoplasmático Liso.",
        "es retenida en el Retículo Endoplasmático Rugoso y enviada a degradación."
    ],
    respuestaCorrecta: "es retenida en el Retículo Endoplasmático Rugoso y enviada a degradación."
  },

  {
    pregunta:
      "Un mecanismo de enfermedad asociado a proteínas de importación nuclear implica la acumulación de las mismas en el citosol debido a:",
    opciones: [
        "Una mayor asociación de ARN mensajeros inmaduros con exportinas para salir del núcleo a través de los poros nucleares.",
        "Una menor asociación de ARN mensajeros maduros con exportinas para salir del núcleo a través de los poros nucleares.",
        "Una mayor asociación de estas proteínas a las importinas/Ran-GTP para entrar al núcleo a través de los poros nucleares.",
        "Una menor asociación de estas proteínas a las importinas/Ran-GTP para entrar al núcleo a través de los poros nucleares."
    ],
    respuestaCorrecta: "Una menor asociación de estas proteínas a las importinas/Ran-GTP para entrar al núcleo a través de los poros nucleares."
  },

  {
    pregunta:
      "La distribución de las mitocondrias en proyecciones distantes del cuerpo celular (por ej en el axón de una neurona) es generado mediante:",
    opciones: [
        "Proteínas motoras kinesinas que se desplazan asociadas a los microtúbulos.",
        "Proteínas motoras dineínas que se desplazan asociadas a microfilamentos.",
        "Difusión en base a distintas concentraciones de mitocondrias.",
        "Proteínas motoras kinesinas que se desplazan asociadas a filamentos intermedios."
    ],
    respuestaCorrecta: "Proteínas motoras kinesinas que se desplazan asociadas a los microtúbulos."
  },

  {
    pregunta:
      "Señale la opción correcta respecto de las proteínas de cubierta vesicular (clatrina, COP I, COP II)",
    opciones: [
        "Seleccionan el compartimento de destino de las vesículas.",
        "Hidrolizan el ATP necesario para el transporte de las vesículas sobre los microtúbulos.",
        "Participan en el proceso de gemación vesicular.",
        "Permiten la fusión de la membrana de la vesícula con el compartimento de destino."
    ],
    respuestaCorrecta: "participan en el proceso de gemación vesicular."
  },
  {
    pregunta: "El transporte de vesículas:",
    opciones: [
        "Es bidireccional (+/-) y permite el tránsito de vesículas de secreción y vesículas endocíticas a través de filamentos de actina.",
        "Es unidireccional y genera el transporte anterógrado de vesículas de secreción hacia el extremo + de los microtúbulos.",
        "Es bidireccional y permite el tránsito de vesículas de secreción, vesículas endocíticas y entre organelas a través de microtúbulos.",
        "Es bidireccional y permite el tránsito de vesículas de secreción, vesículas endocíticas y entre organelas a través de filamentos intermedios."
    ],
    respuestaCorrecta: "Es bidireccional y permite el tránsito de vesículas de secreción, vesículas endocíticas y entre organelas a través de microtúbulos."
  },
];


var nombreUsuario = "";
var preguntaActual = 0;
var puntuacion = 0;
var respuestasUsuario = [];
var tiempoPorPregunta = 30000; // tiempo por defecto: 30 segundos
var temporizador;
var startTime;


function iniciarQuiz(event) {
    event.preventDefault();
    var nombreInput = document.getElementById("nombreInput");
    nombreUsuario = nombreInput.value.trim();
    var velocidadSelect = document.getElementById("velocidadSelect");
    tiempoPorPregunta = parseInt(velocidadSelect.value);

    startTime = new Date().getTime();

    document.getElementById("nombreContainer").style.display = "none";
    document.getElementById("quizContainer").style.display = "block";
    mostrarPregunta();
    iniciarTemporizador();
}

function mostrarPregunta() {
    var pregunta = preguntas[preguntaActual];
    document.getElementById("pregunta").textContent = "Pregunta " + (preguntaActual + 1) + " de " + preguntas.length + ": " + pregunta.pregunta;
    document.getElementById("contadorTiempo").textContent = "Tiempo seleccionado: " + (tiempoPorPregunta / 1000) + " segundos";

    var opciones = document.getElementById("opciones");
    opciones.innerHTML = "";
    for (var i = 0; i < pregunta.opciones.length; i++) {
        var opcion = document.createElement("input");
        opcion.type = "radio";
        opcion.name = "opcion";
        opcion.value = pregunta.opciones[i];
        opcion.id = "opcion" + i;
        opcion.required = true; // Hace que la respuesta sea obligatoria

        var etiqueta = document.createElement("label");
        etiqueta.htmlFor = "opcion" + i;
        etiqueta.textContent = pregunta.opciones[i];

        opciones.appendChild(opcion);
        opciones.appendChild(etiqueta);
        opciones.appendChild(document.createElement("br"));
    }
}

function comprobarRespuesta(event) {
    event.preventDefault();

    detenerTemporizador();

    var opciones = document.getElementsByName("opcion");
    var respuestaUsuario = "";
    for (var i = 0; i < opciones.length; i++) {
        if (opciones[i].checked) {
            respuestaUsuario = opciones[i].value;
            break;
        }
    }

    respuestasUsuario.push({
        pregunta: preguntas[preguntaActual].pregunta,
        respuestaCorrecta: preguntas[preguntaActual].respuestaCorrecta,
        respuestaUsuario: respuestaUsuario,
    });

    if (respuestaUsuario == preguntas[preguntaActual].respuestaCorrecta) {
        puntuacion++;
    }

    preguntaActual++;
    if (preguntaActual < preguntas.length) {
        mostrarPregunta();
        iniciarTemporizador(); // Iniciar el temporizador para la próxima pregunta
    } else {
        finalizarQuiz();
    }
}

function iniciarTemporizador() {
    var tiempoRestante = tiempoPorPregunta / 1000;
    document.getElementById("contadorTiempo").textContent = "Tiempo restante: " + tiempoRestante + " segundos";

    temporizador = setInterval(function () {
        tiempoRestante--;
        document.getElementById("contadorTiempo").textContent = "Tiempo restante: " + tiempoRestante + " segundos";

        if (tiempoRestante <= 0) {
            detenerTemporizador(); // Detener el temporizador actual
            comprobarRespuesta({ preventDefault: function() {} }); // Pasar un evento simulado
        }
    }, 1000);
}


function detenerTemporizador() {
    clearInterval(temporizador);
}

function finalizarQuiz() {
    detenerTemporizador();
    var endTime = new Date().getTime();
    var elapsedTime = endTime - startTime;
    var seconds = Math.floor(elapsedTime / 1000);
    var minutes = Math.floor(seconds / 60);
    seconds %= 60;

    var tiempoElemento = document.getElementById("tiempo");
    if (tiempoElemento) {
        tiempoElemento.textContent = "Te tomó " + minutes + " minutos " + seconds + " segundos en responder todas las preguntas.";
    } else {
        console.error("Elemento 'tiempo' no encontrado.");
    }

    var puntuacionElemento = document.getElementById("puntuacion");
    if (puntuacionElemento) {
        puntuacionElemento.textContent =
            "Puntuación: " +
            puntuacion +
            "/" +
            preguntas.length +
            " (Correctas: " +
            puntuacion +
            ", Incorrectas: " +
            (preguntas.length - puntuacion) +
            ")";
    } else {
        console.error("Elemento 'puntuacion' no encontrado.");
    }

    var resumen = document.getElementById("resumen");
    if (resumen) {
        resumen.innerHTML = "";
        for (var i = 0; i < respuestasUsuario.length; i++) {
            // Create list items for each response
            var item = document.createElement("li");
            item.textContent =
                "Pregunta: " +
                respuestasUsuario[i].pregunta +
                " - Respuesta correcta: " +
                respuestasUsuario[i].respuestaCorrecta +
                " - Tu respuesta: " +
                (respuestasUsuario[i].respuestaUsuario || "No respondida");
            if (
                respuestasUsuario[i].respuestaUsuario ==
                respuestasUsuario[i].respuestaCorrecta
            ) {
                item.style.color = "green";
            } else {
                item.style.color = "red";
            }
            resumen.appendChild(item);
        }
    } else {
        console.error("Elemento 'resumen' no encontrado.");
    }

    // Display the result container
    var resultadoContainer = document.getElementById("resultado");
    if (resultadoContainer) {
        resultadoContainer.style.display = "block";
    } else {
        console.error("Elemento 'resultado' no encontrado.");
    }

    // Hide the quiz container
    var quizContainer = document.getElementById("quizContainer");
    if (quizContainer) {
        quizContainer.style.display = "none";
    } else {
        console.error("Elemento 'quizContainer' no encontrado.");
    }
}

function reiniciarQuiz() {
    preguntaActual = 0;
    puntuacion = 0;
    respuestasUsuario = [];
    document.getElementById("quizForm").reset(); // Resetea el formulario de respuestas
    document.getElementById("nombreContainer").style.display = "block"; // Muestra el formulario de nombre
    document.getElementById("quizContainer").style.display = "none";
    document.getElementById("resultado").style.display = "none";
}
